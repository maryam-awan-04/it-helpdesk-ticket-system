{% extends 'admin/base.html' %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
    <div class="assigned-summary">
        <div class="assigned-summary-box">
            <h2>My Assigned Tickets</h2>
            <div class="count">{% if assigned_tickets %}{{ assigned_tickets|length }}{% else %}0{% endif %}</div>
        </div>
        <div class="assigned-summary-box">
            <h2>My Tickets In Progress</h2>
            <div class="count">{% if in_progress_tickets %}{{ in_progress_tickets|length }}{% else %}0{% endif %}</div>
        </div>
    </div>

    <div class="assigned-tickets">
        <div class="assigned-tickets-box">
            <h2>My Assigned Tickets</h2>
            <div class="filter-container">
                <label for="filterBy" class="filter-label">Filter By:</label>
                <select id="filterBy" class="filter-select">
                    <option value="">All</option>
                    <option value="date">Date</option>
                    <option value="request_type">Request Type</option>
                    <option value="status">Status</option>
                    <option value="title">Title</option>
                </select>
            </div>
        </div>
        <table class="ticket-table">
            <thead>
                <tr>
                    <th>Request ID</th>
                    <th>Date Opened</th>
                    <th>Request Type</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Status</th>
                    <th>Feedback Score</th>
                </tr>
            </thead>
            <tbody>
                {% if all_tickets %}
                    {% for ticket in all_tickets %}
                        <tr>
                            <td>{{ ticket.id }}</td>
                            <td>{{ ticket.date_opened }}</td>
                            <td>{{ ticket.request_type }}</td>
                            <td>{{ ticket.title }}</td>
                            <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">{{ ticket.description }}</td>
                            <td>{{ ticket.status }}</td>
                            <td>{{ ticket.feedback_score }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr><td colspan="4">No ticket history available.</td></tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <div class="unassigned-tickets">
        <div class="unassigned-tickets-box">
            <h2>Open Unassigned Tickets</h2>
            <div class="filter-container">
                <label for="filterBy" class="filter-label">Filter By:</label>
                <select id="filterBy" class="filter-select">
                    <option value="">All</option>
                    <option value="date">Date</option>
                    <option value="request_type">Request Type</option>
                    <option value="status">Status</option>
                    <option value="title">Title</option>
                </select>
            </div>
        </div>
        <table class="ticket-table">
            <thead>
                <tr>
                    <th>Request ID</th>
                    <th>Date Opened</th>
                    <th>Request Type</th>
                    <th>Title</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                {% if all_tickets %}
                    {% for ticket in all_tickets %}
                        <tr>
                            <td>{{ ticket.id }}</td>
                            <td>{{ ticket.date_opened }}</td>
                            <td>{{ ticket.request_type }}</td>
                            <td>{{ ticket.title }}</td>
                            <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">{{ ticket.description }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr><td colspan="4">No ticket history available.</td></tr>
                {% endif %}
            </tbody>
        </table>
    </div>
{% endblock %}
